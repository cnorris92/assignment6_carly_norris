---
title: "Political Affiliation vs. Environmentalist Self-Identification"
author: "Carly Norris"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(broom)
```

## Introduction

This report examines the relationship between individuals self-identification as an environmentalist (yes, no, unsure) and political affiliation using a binary response of liberal vs. conservative. Data was taken from an anonymous survey conducted by Chelsea Batavia and Andrews Forest in 2017 (n= 1,331), exploring the influences on charitable giving for conservation (see citation). A Chi-square test will be used to understand if variables are independent. 


```{r}
# read in data
conservation_survey_simple <- read_csv(here("data", "conservation_survey.csv")) %>% 
  clean_names() %>% 
  select(env_id, pol_or) # only select political affiliation and environmentalist

# organizing by political alignment into only two values representing conservative (pol_or = 1-3) or liberal (pol_or = 5-7)
survey_binary_party <- conservation_survey_simple %>% 
  filter(pol_or == c(1, 2, 3, 5, 6, 7)) %>% 
  mutate(pol_align = case_when(pol_or <= 3 ~ "Conservative",
                               pol_or >= 5 ~ "Liberal"))
```

#### Table 1. Add table title.

```{r}
# table political alignment vs. environmental 
q1_counts <- survey_binary_party %>% 
  tabyl(pol_align, env_id) %>% 
  rename("Political Alignment" = "pol_align", "Yes" = "1", "No" = "2", "Unsure" = "3")

# create proportions table
q1_proportions <- q1_counts %>% 
  adorn_percentages() %>% 
  adorn_pct_formatting(digits = 2) %>% 
  adorn_ns()

# display finalized table
kbl(q1_proportions) %>% 
    kable_material(full_width = F)
```


#### Chi-squared test for variable independence between self-identification as an environmentalist and political alignment.

```{r}
# convert data to contingency table
q1_ct <- q1_counts %>% 
  column_to_rownames(var = "Political Alignment")

# run chi-square test
q1_x2 <- chisq.test(q1_ct)

# convert to tidy data for in line referencing
q1_tidy <- tidy(q1_x2)
```

In 2-3 sentences, using in-line referencing to the chi-square test results, describe the results of the statistical test and briefly highlight major takeaways that your reader should learn from your analysis (i.e., you should refer to the actual proportions here).


Citation: Andrews Forest LTER Site and C. Batavia. 2019. Influences on charitable giving for conservation: Online survey data of 1,331 respondents across the US, August 2017 ver 3. Environmental Data Initiative. https://doi.org/10.6073/pasta/926e6270e324a1322a900da14d38b96c

